#= require app
#= require models/region-type-db
#= require models/indicator-db
#= require models/region-store

models = window.OpenCensus.models

region_types = new models.RegionTypeDb(<%= RegionType.order(:position).map{|rt| { name: rt.name, description: rt.name } }.to_json %>)
indicators = new models.IndicatorDb(<%= Indicator.order(:name).map{|i| i.attributes }.to_json %>)
region_store = new models.RegionStore(region_types)

window.OpenCensus.globals = {
  defaults: {
    indicator_key: 'pop',
    position: {
      latitude: 45.5,
      longitude: -73.5,
      zoom: 11
    }
  },
  style: {
    stroke: '#ffffff',
    'stroke-width': '0.25%',
    opacity: 0.6,
  },
  hover_style: {
    stroke: '#000000',
    'stroke-width': '0.4%',
  },
  selected_style: {
    stroke: '#000000',
    'stroke-width': '0.85%',
  },
  json_tile_url: '/tiles'
  region_types: region_types,
  indicators: indicators,
  region_store: region_store,
  min_zoom: 3,
  max_zoom: 15
}
